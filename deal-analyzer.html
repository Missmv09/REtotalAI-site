<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Deal Analyzer â€¢ REtotalAI</title>
  <!-- auth guard + supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/scripts/auth.js"></script>
  <style>
    body { font-family:sans-serif; max-width:700px; margin:40px auto; line-height:1.6; }
    h2 { color:#111; }
    input { width:100%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:4px; font-size:16px; }
    button { padding:10px 16px; border:none; background:#222; color:#fff; border-radius:6px; cursor:pointer; }
    .result { background:#f9f9f9; border-radius:6px; padding:15px; margin-top:20px; display:none; }
    .result h3 { margin-top:0; }
  </style>
</head>
<body>
  <h2>Deal Analyzer</h2>
  <p>Enter your property details:</p>

  <label>Purchase Price</label>
  <input type="number" id="price" placeholder="e.g. 400000" inputmode="decimal">

  <label>Monthly Rent</label>
  <input type="number" id="rent" placeholder="e.g. 2800" inputmode="decimal">

  <label>Monthly Expenses (taxes, insurance, etc.)</label>
  <input type="number" id="expenses" placeholder="e.g. 600" inputmode="decimal">

  <button onclick="analyze()">Analyze Deal</button>

  <div id="results" class="result">
    <h3>Results</h3>
    <p><strong>ROI:</strong> <span id="roi"></span>%</p>
    <p><strong>Cap Rate:</strong> <span id="capRate"></span>%</p>
    <p><strong>Cash Flow:</strong> $<span id="cashFlow"></span>/month</p>
  </div>

  <script>
    (async()=>{ await requireAuth(); })();

    function analyze() {
      const price = Number(document.getElementById("price").value);
      const rent = Number(document.getElementById("rent").value);
      const expenses = Number(document.getElementById("expenses").value || 0);
      if (!price || !rent) return alert("Please enter price and rent.");

      const annualRent = rent * 12;
      const annualExpenses = expenses * 12;
      const netAnnual = annualRent - annualExpenses;

      const capRate = ((netAnnual / price) * 100).toFixed(2);
      const roi = ((netAnnual / price) * 100).toFixed(2); // simple ROI; refine later with financing
      const cashFlow = (rent - expenses).toFixed(2);

      document.getElementById("roi").textContent = roi;
      document.getElementById("capRate").textContent = capRate;
      document.getElementById("cashFlow").textContent = cashFlow;
      document.getElementById("results").style.display = "block";
    }
  </script>
</body>
</html>
