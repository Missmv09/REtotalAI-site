<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Renovation Estimator • REtotalAI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #0b1020;
      --card-bg: #151a2b;
      --accent: #f5b72f;
      --accent-soft: rgba(245, 183, 47, 0.15);
      --text: #f7f7ff;
      --subtle: #a6acc7;
      --border: #252a3f;
      --error: #ff6b6b;
      --success: #3ad29f;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #151a2b 0, #050814 55%, #02030a 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 32px 16px 48px;
      display: flex;
      justify-content: center;
    }

    .page { width: 100%; max-width: 1080px; }

    header { margin-bottom: 24px; }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--accent-soft);
      background: rgba(10, 16, 40, 0.85);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--subtle);
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 10px rgba(245, 183, 47, 0.7);
    }

    h1 {
      margin: 12px 0 4px;
      font-size: clamp(26px, 3vw, 30px);
      letter-spacing: 0.03em;
    }

    .subtitle {
      margin: 0;
      color: var(--subtle);
      font-size: 14px;
      max-width: 620px;
    }

    .grid {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2.4fr);
      gap: 20px;
      margin-top: 24px;
    }

    @media (max-width: 840px) {
      .grid { grid-template-columns: minmax(0, 1fr); }
    }

    .card {
      background: radial-gradient(circle at top left, #1b2239 0, #101525 45%, #0a0d19 100%);
      border-radius: 18px;
      border: 1px solid var(--border);
      padding: 18px 18px 20px;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.55);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 10px;
    }

    .card-title { font-size: 16px; font-weight: 600; }

    .card-description { font-size: 13px; color: var(--subtle); }

    .pill {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15, 112, 240, 0.1);
      border: 1px solid rgba(80, 146, 255, 0.5);
      color: #c2d6ff;
      white-space: nowrap;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px 12px;
      margin-top: 10px;
    }

    @media (max-width: 640px) {
      .form-grid { grid-template-columns: minmax(0, 1fr); }
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 13px;
    }

    .field label {
      color: var(--subtle);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 4px;
    }

    .hint { font-size: 11px; color: #7b82a3; }

    input[type="number"],
    select {
      border-radius: 10px;
      border: 1px solid var(--border);
      padding: 8px 9px;
      font-size: 13px;
      background: rgba(3, 5, 15, 0.85);
      color: var(--text);
      outline: none;
      width: 100%;
    }

    input[type="number"]:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(245, 183, 47, 0.4);
    }

    .checkbox-group {
      margin-top: 10px;
      padding: 10px;
      border-radius: 12px;
      background: linear-gradient(
        135deg,
        rgba(245, 183, 47, 0.06),
        rgba(14, 19, 41, 0.9)
      );
      border: 1px dashed rgba(245, 183, 47, 0.5);
    }

    .checkbox-title {
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .checkbox-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 4px 10px;
    }

    @media (max-width: 640px) {
      .checkbox-row { grid-template-columns: minmax(0, 1fr); }
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--subtle);
    }

    .checkbox-item input[type="checkbox"] { accent-color: var(--accent); }

    .checkbox-item span { flex: 1; }

    .unit-inputs {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 6px;
      margin-top: 8px;
    }

    .unit-inputs .field { font-size: 12px; }

    .button-row {
      margin-top: 14px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      border: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      border-radius: 999px;
      padding: 8px 16px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #f5b72f, #ffde7a);
      color: #281a04;
      box-shadow:
        0 12px 30px rgba(0, 0, 0, 0.6),
        0 0 28px rgba(245, 183, 47, 0.5);
    }

    .btn-primary:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
    }

    .btn-ghost {
      background: transparent;
      color: var(--subtle);
      border: 1px solid rgba(104, 116, 167, 0.7);
    }

    .btn-ghost:hover { background: rgba(13, 19, 48, 0.8); }

    .results-card { position: relative; overflow: hidden; }

    .results-card::before {
      content: "";
      position: absolute;
      inset: -60%;
      background: radial-gradient(
        circle at top,
        rgba(245, 183, 47, 0.09) 0,
        transparent 55%
      );
      opacity: 0.8;
      pointer-events: none;
    }

    .results-inner { position: relative; z-index: 1; }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-top: 8px;
    }

    @media (max-width: 640px) {
      .results-grid { grid-template-columns: minmax(0, 1fr); }
    }

    .stat {
      border-radius: 12px;
      background: radial-gradient(
        circle at top,
        rgba(19, 26, 60, 0.9),
        rgba(8, 10, 24, 0.95)
      );
      border: 1px solid rgba(40, 45, 81, 0.9);
      padding: 10px 12px;
      font-size: 12px;
    }

    .stat-label {
      color: var(--subtle);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      margin-bottom: 4px;
    }

    .stat-value { font-size: 18px; font-weight: 600; }

    .stat-sub { font-size: 11px; color: #7b82a3; margin-top: 2px; }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 11px;
      margin-top: 10px;
    }

    .chip {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(74, 181, 127, 0.5);
      background: rgba(10, 35, 29, 0.9);
      color: #b7f2d5;
    }

    .chip-warn {
      border-color: rgba(245, 183, 47, 0.5);
      background: rgba(47, 33, 6, 0.9);
      color: #ffe0a1;
    }

    .line-item-list {
      margin-top: 12px;
      border-top: 1px dashed rgba(63, 70, 112, 0.85);
      padding-top: 10px;
      max-height: 180px;
      overflow-y: auto;
      font-size: 12px;
    }

    .line-item {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 4px;
      color: var(--subtle);
    }

    .line-item span:last-child { font-variant-numeric: tabular-nums; }

    .line-item-strong {
      color: var(--text);
      font-weight: 600;
      margin-top: 4px;
    }

    .helper-text {
      margin-top: 8px;
      font-size: 11px;
      color: #7b82a3;
    }

    .helper-text strong {
      color: var(--accent);
      font-weight: 600;
    }

    .error {
      margin-top: 6px;
      font-size: 11px;
      color: var(--error);
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="badge">
        <span class="badge-dot"></span>
        REtotalAI • Renovation Estimator (Beta)
      </div>
      <h1>Estimate Your Rehab Costs in Seconds</h1>
      <p class="subtitle">
        Plug in the property size and scope, and we’ll generate a fast,
        investor-friendly renovation budget with ranges and a built-in
        contingency buffer. You can refine the assumptions later.
      </p>
    </header>

    <div class="grid">
      <!-- LEFT: INPUT CARD -->
      <section class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Property &amp; Scope</div>
            <p class="card-description">
              Start with the basics: square footage, kitchens, bathrooms, and the
              high-level work you plan to do.
            </p>
          </div>
          <div class="pill">Quick Inputs</div>
        </div>

        <form id="renovation-form" novalidate>
          <div class="form-grid">
            <div class="field">
              <label for="squareFeet">
                Total Square Footage
                <span class="hint">Living area only</span>
              </label>
              <input
                id="squareFeet"
                name="squareFeet"
                type="number"
                min="0"
                step="1"
                placeholder="e.g. 1,500"
                required
              />
            </div>

            <div class="field">
              <label for="conditionLevel">
                Current Condition
                <span class="hint">For cost assumptions</span>
              </label>
              <select id="conditionLevel" name="conditionLevel">
                <option value="light">Light cosmetic</option>
                <option value="medium" selected>Medium rehab</option>
                <option value="heavy">Heavy / down to studs</option>
              </select>
            </div>

            <!-- NEW: Market / Location -->
            <div class="field">
              <label for="locationLevel">
                Market / Location
                <span class="hint">Cost-of-living factor</span>
              </label>
              <select id="locationLevel" name="locationLevel">
                <option value="baseline" selected>Baseline (most markets)</option>
                <option value="high">High-cost metro (SF, LA, NYC)</option>
                <option value="low">Lower-cost market (Midwest / South)</option>
              </select>
            </div>
            <!-- END NEW -->

            <div class="field">
              <label for="kitchens">
                Number of Kitchens
                <span class="hint">Usually 1 for SFR</span>
              </label>
              <input
                id="kitchens"
                name="kitchens"
                type="number"
                min="0"
                step="1"
                placeholder="e.g. 1"
              />
            </div>

            <div class="field">
              <label for="bathrooms">
                Number of Bathrooms
                <span class="hint">Full and 3/4 baths</span>
              </label>
              <input
                id="bathrooms"
                name="bathrooms"
                type="number"
                min="0"
                step="1"
                placeholder="e.g. 2"
              />
            </div>
          </div>

          <div class="checkbox-group">
            <div class="checkbox-title">
              <span>Include These Scopes</span>
              <span class="hint">Toggle what you plan to touch</span>
            </div>
            <div class="checkbox-row">
              <label class="checkbox-item">
                <input type="checkbox" id="scopePaint" checked />
                <span>Interior Paint</span>
                <span class="hint">Per sq ft</span>
              </label>

              <label class="checkbox-item">
                <input type="checkbox" id="scopeFlooring" checked />
                <span>New Flooring</span>
                <span class="hint">Per sq ft</span>
              </label>

              <label class="checkbox-item">
                <input type="checkbox" id="scopeRoof" />
                <span>Roof Replacement</span>
                <span class="hint">Per sq ft (roof)</span>
              </label>

              <label class="checkbox-item">
                <input type="checkbox" id="scopeWindows" />
                <span>New Windows</span>
                <span class="hint">Per window</span>
              </label>

              <label class="checkbox-item">
                <input type="checkbox" id="scopeLandscaping" />
                <span>Landscaping / Curb Appeal</span>
                <span class="hint">Flat</span>
              </label>

              <label class="checkbox-item">
                <input type="checkbox" id="scopeMisc" />
                <span>Misc / Systems (HVAC, electrical, etc.)</span>
                <span class="hint">Flat</span>
              </label>
            </div>

            <div class="unit-inputs">
              <div class="field">
                <label for="numWindows">
                  Windows (if selected)
                  <span class="hint">Approx. count</span>
                </label>
                <input
                  id="numWindows"
                  name="numWindows"
                  type="number"
                  min="0"
                  step="1"
                  placeholder="e.g. 8"
                />
              </div>
              <div class="field">
                <label for="customContingency">
                  Contingency %
                  <span class="hint">Default 10%</span>
                </label>
                <input
                  id="customContingency"
                  name="customContingency"
                  type="number"
                  min="0"
                  step="1"
                  placeholder="10"
                />
              </div>
            </div>
          </div>

          <div class="button-row">
            <button type="submit" class="btn-primary">
              Run Renovation Estimate
            </button>
            <button type="button" id="resetButton" class="btn-ghost">
              Reset
            </button>
          </div>

          <p id="errorMsg" class="error" style="display: none;"></p>
          <p class="helper-text">
            These are <strong>conservative planning numbers</strong> based on
            typical Home Depot + mid-market labor costs. On-the-ground bids will
            always win — this is to help you underwrite quickly.
          </p>
        </form>
      </section>

      <!-- RIGHT: RESULTS CARD -->
      <section class="card results-card">
        <div class="results-inner">
          <div class="card-header">
            <div>
              <div class="card-title">Renovation Budget</div>
              <p class="card-description">
                Live estimate based on your inputs. Use this for first-pass deal
                analysis, then refine as you collect real bids.
              </p>
            </div>
            <div class="pill">Investor View</div>
          </div>

          <div class="results-grid">
            <div class="stat">
              <div class="stat-label">Est. Total Budget</div>
              <div id="totalBudget" class="stat-value">$0</div>
              <div id="totalBudgetNote" class="stat-sub">
                Includes contingency
              </div>
            </div>

            <div class="stat">
              <div class="stat-label">Range (Low – High)</div>
              <div id="rangeBudget" class="stat-value">$0 – $0</div>
              <div class="stat-sub">
                Uses ±10% swing from base
              </div>
            </div>
          </div>

          <div class="chips">
            <div class="chip" id="costPerSqftChip">$0 / sq ft</div>
            <div class="chip-warn" id="contingencyChip">
              10% contingency applied
            </div>
            <!-- NEW: Location chip -->
            <div class="chip" id="locationChip">
              Baseline market (×1.00)
            </div>
            <!-- END NEW -->
          </div>

          <div class="line-item-list" id="lineItems">
            <div class="line-item-strong">
              No estimate yet — fill in the form and click “Run Renovation
              Estimate”.
            </div>
          </div>

          <!-- Use in Deal Analyzer -->
          <div class="button-row" style="margin-top: 14px;">
            <button type="button" id="sendToDealAnalyzer" class="btn-primary">
              Use in Deal Analyzer
            </button>
          </div>
          <p id="sendConfirm" class="helper-text" style="display: none;">
            Renovation estimate saved and sent as the all-in (high) budget with
            contingency. Opening Deal Analyzer…
          </p>

          <p class="helper-text">
            Next step: plug this renovation number into your
            <strong>Deal Analyzer</strong> or <strong>Fix &amp; Flip</strong>
            calculator to see total project cost, equity, and projected returns.
          </p>
        </div>
      </section>
    </div>
  </div>

  <script>
    (function () {
      // Baseline cost assumptions — you can tweak these later or make them dynamic
      const COSTS = {
        paintPerSqft: 2.5,       // $ / sqft
        flooringPerSqft: 5.0,    // $ / sqft
        roofPerSqft: 4.5,        // $ / sqft (rough estimate)
        windowPerUnit: 700,      // $ per window
        landscapingFlat: 3000,
        miscSystemsFlat: 4000,
        kitchenPerUnit: 15000,
        bathroomPerUnit: 8000,
        defaultContingencyPct: 10
      };

      function toNumber(value) {
        const n = Number(value);
        return isNaN(n) || !isFinite(n) ? 0 : n;
      }

      function formatMoney(value) {
        return (
          "$" +
          value.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",")
        );
      }

      const form = document.getElementById("renovation-form");
      const errorMsg = document.getElementById("errorMsg");
      const totalBudgetEl = document.getElementById("totalBudget");
      const totalBudgetNoteEl = document.getElementById("totalBudgetNote");
      const rangeBudgetEl = document.getElementById("rangeBudget");
      const costPerSqftChip = document.getElementById("costPerSqftChip");
      const contingencyChip = document.getElementById("contingencyChip");
      const locationChip = document.getElementById("locationChip");
      const lineItemsEl = document.getElementById("lineItems");
      const resetButton = document.getElementById("resetButton");
      const sendToDealAnalyzerBtn = document.getElementById("sendToDealAnalyzer");
      const sendConfirm = document.getElementById("sendConfirm");

      // store last calculated total (with contingency) so we can send it to Deal Analyzer
      let lastTotalWithContingency = 0;

      form.addEventListener("submit", function (event) {
        event.preventDefault();
        errorMsg.style.display = "none";
        errorMsg.textContent = "";

        const squareFeet = toNumber(document.getElementById("squareFeet").value);
        const conditionLevel =
          document.getElementById("conditionLevel").value || "medium";
        const locationLevel =
          document.getElementById("locationLevel").value || "baseline";

        // IMPORTANT: no default of 1 here — blank means 0, and we won't add line items
        const kitchens = toNumber(document.getElementById("kitchens").value);
        const bathrooms = toNumber(document.getElementById("bathrooms").value);

        const numWindows = toNumber(document.getElementById("numWindows").value);
        const customContingency = toNumber(
          document.getElementById("customContingency").value
        );

        const scopePaint = document.getElementById("scopePaint").checked;
        const scopeFlooring = document.getElementById("scopeFlooring").checked;
        const scopeRoof = document.getElementById("scopeRoof").checked;
        const scopeWindows = document.getElementById("scopeWindows").checked;
        const scopeLandscaping =
          document.getElementById("scopeLandscaping").checked;
        const scopeMisc = document.getElementById("scopeMisc").checked;

        if (!squareFeet || squareFeet <= 0) {
          errorMsg.textContent =
            "Please enter a valid total square footage to run the estimate.";
          errorMsg.style.display = "block";
          return;
        }

        // Adjust cost multipliers based on condition
        let conditionMultiplier = 1;
        if (conditionLevel === "light") {
          conditionMultiplier = 0.9;
        } else if (conditionLevel === "heavy") {
          conditionMultiplier = 1.2;
        }

        // NEW: Location multiplier
        let locationMultiplier = 1;
        if (locationLevel === "high") {
          locationMultiplier = 1.15;
        } else if (locationLevel === "low") {
          locationMultiplier = 0.9;
        }

        const costMultiplier = conditionMultiplier * locationMultiplier;

        // update location chip text
        if (locationChip) {
          if (locationLevel === "high") {
            locationChip.textContent = "High-cost market (×1.15)";
          } else if (locationLevel === "low") {
            locationChip.textContent = "Lower-cost market (×0.90)";
          } else {
            locationChip.textContent = "Baseline market (×1.00)";
          }
        }

        const lineItems = [];
        let baseCost = 0;

        // Kitchens (only if user entered > 0)
        if (kitchens > 0) {
          const kitchenCost =
            kitchens * COSTS.kitchenPerUnit * costMultiplier;
          baseCost += kitchenCost;
          lineItems.push({
            label: `Kitchens (${kitchens})`,
            value: kitchenCost
          });
        }

        // Bathrooms (only if user entered > 0)
        if (bathrooms > 0) {
          const bathCost =
            bathrooms * COSTS.bathroomPerUnit * costMultiplier;
          baseCost += bathCost;
          lineItems.push({
            label: `Bathrooms (${bathrooms})`,
            value: bathCost
          });
        }

        // Paint
        if (scopePaint) {
          const paintCost =
            squareFeet * COSTS.paintPerSqft * costMultiplier;
          baseCost += paintCost;
          lineItems.push({
            label: `Interior paint (${squareFeet.toFixed(0)} sq ft)`,
            value: paintCost
          });
        }

        // Flooring
        if (scopeFlooring) {
          const flooringCost =
            squareFeet * COSTS.flooringPerSqft * costMultiplier;
          baseCost += flooringCost;
          lineItems.push({
            label: `New flooring (${squareFeet.toFixed(0)} sq ft)`,
            value: flooringCost
          });
        }

        // Roof
        if (scopeRoof) {
          // assume roof area ~ 1.1x square footage
          const roofSqft = squareFeet * 1.1;
          const roofCost = roofSqft * COSTS.roofPerSqft * costMultiplier;
          baseCost += roofCost;
          lineItems.push({
            label: `Roof replacement (~${roofSqft.toFixed(0)} sq ft)`,
            value: roofCost
          });
        }

        // Windows
        if (scopeWindows && numWindows > 0) {
          const windowsCost =
            numWindows * COSTS.windowPerUnit * costMultiplier;
          baseCost += windowsCost;
          lineItems.push({
            label: `Windows (${numWindows} units)`,
            value: windowsCost
          });
        }

        // Landscaping
        if (scopeLandscaping) {
          const landscapingCost =
            COSTS.landscapingFlat * costMultiplier;
          baseCost += landscapingCost;
          lineItems.push({
            label: "Landscaping / curb appeal",
            value: landscapingCost
          });
        }

        // Misc / systems
        if (scopeMisc) {
          const miscCost = COSTS.miscSystemsFlat * costMultiplier;
          baseCost += miscCost;
          lineItems.push({
            label: "Misc systems (HVAC, electrical, plumbing buffer)",
            value: miscCost
          });
        }

        if (baseCost <= 0) {
          errorMsg.textContent =
            "Please select at least one scope item or enter kitchens/bathrooms to estimate.";
          errorMsg.style.display = "block";
          return;
        }

        const contingencyPct =
          customContingency > 0
            ? customContingency
            : COSTS.defaultContingencyPct;
        const contingencyAmount = (baseCost * contingencyPct) / 100;
        const totalWithContingency = baseCost + contingencyAmount;

        // remember latest total (this is the *high* all-in we send to Deal Analyzer)
        lastTotalWithContingency = totalWithContingency;

        const lowRange = baseCost * 0.9;
        const highRange = baseCost * 1.1;

        const costPerSqft = totalWithContingency / squareFeet;

        // Update UI
        totalBudgetEl.textContent = formatMoney(totalWithContingency);
        totalBudgetNoteEl.textContent =
          "Base " +
          formatMoney(baseCost) +
          " + " +
          contingencyPct.toFixed(0) +
          "% contingency (" +
          formatMoney(contingencyAmount) +
          ")";

        rangeBudgetEl.textContent =
          formatMoney(lowRange) + " – " + formatMoney(highRange);

        costPerSqftChip.textContent =
          formatMoney(costPerSqft) + " / sq ft (all-in)";

        contingencyChip.textContent =
          contingencyPct.toFixed(0) + "% contingency applied";

        // Line items rendering
        lineItemsEl.innerHTML = "";
        lineItems.forEach(function (item) {
          const row = document.createElement("div");
          row.className = "line-item";
          const labelSpan = document.createElement("span");
          labelSpan.textContent = item.label;
          const valueSpan = document.createElement("span");
          valueSpan.textContent = formatMoney(item.value);
          row.appendChild(labelSpan);
          row.appendChild(valueSpan);
          lineItemsEl.appendChild(row);
        });

        const totalRow = document.createElement("div");
        totalRow.className = "line-item line-item-strong";
        const totalLabel = document.createElement("span");
        totalLabel.textContent = "Base total (before contingency)";
        const totalValue = document.createElement("span");
        totalValue.textContent = formatMoney(baseCost);
        totalRow.appendChild(totalLabel);
        totalRow.appendChild(totalValue);
        lineItemsEl.appendChild(totalRow);

        if (sendConfirm) {
          sendConfirm.style.display = "none";
        }
      });

      // Send to Deal Analyzer handler
      sendToDealAnalyzerBtn.addEventListener("click", function () {
        errorMsg.style.display = "none";
        errorMsg.textContent = "";

        if (!lastTotalWithContingency || lastTotalWithContingency <= 0) {
          errorMsg.textContent =
            "Run a renovation estimate first, then send it to the Deal Analyzer.";
          errorMsg.style.display = "block";
          return;
        }

        try {
          const rounded = Math.round(lastTotalWithContingency);
          // this is the high / all-in estimate with contingency
          localStorage.setItem("retotalai_reno_estimate", String(rounded));
        } catch (e) {
          console.warn("Unable to store reno estimate in localStorage", e);
        }

        if (sendConfirm) {
          sendConfirm.style.display = "block";
        }

        window.location.href = "/deal-analyzer.html";
      });

      resetButton.addEventListener("click", function () {
        form.reset();
        lastTotalWithContingency = 0;
        errorMsg.style.display = "none";
        errorMsg.textContent = "";
        totalBudgetEl.textContent = "$0";
        totalBudgetNoteEl.textContent = "Includes contingency";
        rangeBudgetEl.textContent = "$0 – $0";
        costPerSqftChip.textContent = "$0 / sq ft";
        contingencyChip.textContent = "10% contingency applied";
        if (locationChip) {
          locationChip.textContent = "Baseline market (×1.00)";
        }
        lineItemsEl.innerHTML =
          '<div class="line-item-strong">No estimate yet — fill in the form and click “Run Renovation Estimate”.</div>';
        if (sendConfirm) {
          sendConfirm.style.display = "none";
        }
      });
    })();
  </script>
</body>
</html>
