<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Renovation Estimator • REtotalAI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #0b1020;
      --card-bg: #151a2b;
      --accent: #f5b72f;
      --accent-soft: rgba(245, 183, 47, 0.15);
      --text: #f7f7ff;
      --subtle: #a6acc7;
      --border: #252a3f;
      --error: #ff6b6b;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: radial-gradient(circle at top, #151a2b 0, #050814 55%, #02030a 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 32px 16px 48px;
      display: flex;
      justify-content: center;
    }

    .page { width: 100%; max-width: 1080px; }

    header { margin-bottom: 24px; }

    .badge {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 4px 10px; border-radius: 999px;
      border: 1px solid var(--accent-soft);
      background: rgba(10, 16, 40, 0.85);
      font-size: 11px; letter-spacing: 0.08em; text-transform: uppercase;
      color: var(--subtle);
    }

    .badge-dot {
      width: 6px; height: 6px; border-radius: 999px;
      background: var(--accent);
    }

    h1 { margin: 12px 0 4px; font-size: 30px; }

    .subtitle { margin: 0; color: var(--subtle); font-size: 14px; max-width: 620px; }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 24px;
    }

    @media (max-width: 840px) { .grid { grid-template-columns: 1fr; } }

    .card {
      background: #111628;
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 18px;
    }

    .card-header { margin-bottom: 10px; }

    .card-title { font-size: 16px; font-weight: 600; }

    .card-description { font-size: 13px; color: var(--subtle); }

    input[type="number"], select {
      width: 100%;
      padding: 8px;
      border-radius: 10px;
      background: #0d1222;
      border: 1px solid var(--border);
      color: var(--text);
    }

    .button-row { margin-top: 14px; display: flex; gap: 10px; }

    button {
      padding: 8px 16px;
      border-radius: 999px;
      font-weight: 600;
      cursor: pointer;
      border: none;
    }

    .btn-primary {
      background: #f5b72f;
      color: #1a1202;
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid #666;
      color: var(--subtle);
    }

    .error { color: var(--error); font-size: 11px; margin-top: 6px; }

    .line-item { display: flex; justify-content: space-between; margin-bottom: 4px; }
    .line-item-strong { font-weight: 700; margin-top: 6px; }
  </style>
</head>

<body>
<div class="page">

  <header>
    <div class="badge">
      <span class="badge-dot"></span> REtotalAI • Renovation Estimator (Beta)
    </div>
    <h1>Estimate Your Rehab Costs in Seconds</h1>
    <p class="subtitle">
      Plug in property size and scope, and we’ll generate an investor-friendly renovation budget with ranges and contingency.
    </p>
  </header>

  <div class="grid">
    <section class="card">
      <div class="card-header">
        <div class="card-title">Property & Scope</div>
        <p class="card-description">Basic inputs: square footage, kitchens, bathrooms, scopes.</p>
      </div>

      <form id="renovation-form" novalidate>
        <label>Total Square Footage</label>
        <input id="squareFeet" type="number" placeholder="e.g. 1500" required />

        <label>Current Condition</label>
        <select id="conditionLevel">
          <option value="light">Light</option>
          <option value="medium" selected>Medium</option>
          <option value="heavy">Heavy</option>
        </select>

        <label>Number of Kitchens</label>
        <input id="kitchens" type="number" placeholder="e.g. 1" />

        <label>Number of Bathrooms</label>
        <input id="bathrooms" type="number" placeholder="e.g. 2" />

        <label>Windows (if selected)</label>
        <input id="numWindows" type="number" placeholder="e.g. 8" />

        <label>Contingency % (default 10%)</label>
        <input id="customContingency" type="number" placeholder="10" />

        <div class="button-row">
          <button class="btn-primary" type="submit">Run Renovation Estimate</button>
          <button class="btn-ghost" type="button" id="resetBtn">Reset</button>
        </div>

        <p id="errorMsg" class="error" style="display:none;"></p>
      </form>
    </section>

    <section class="card">
      <div class="card-title">Renovation Budget</div>
      <h2 id="totalBudget">$0</h2>
      <p id="totalNote" class="subtitle">Includes contingency</p>

      <div id="lineItems">
        <div class="line-item-strong">No estimate yet.</div>
      </div>

      <button class="btn-primary" id="sendToDealAnalyzer" style="margin-top:14px;">
        Use in Deal Analyzer
      </button>

      <p id="sendConfirm" class="subtitle" style="display:none;">Saved. Opening Deal Analyzer…</p>
    </section>
  </div>
</div>

<script>
(function () {

  const COSTS = {
    kitchenPerUnit: 15000,
    bathroomPerUnit: 8000,
    paintPerSqft: 2.5,
    flooringPerSqft: 5.0,
    roofPerSqft: 4.5,
    windowPerUnit: 700,
    landscapingFlat: 3000,
    miscSystemsFlat: 4000,
    defaultContingencyPct: 10
  };

  function toNumber(v) {
    const n = Number(v);
    return isNaN(n) ? 0 : n;
  }

  function money(v) {
    return "$" + v.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  }

  const form = document.getElementById("renovation-form");
  const errorMsg = document.getElementById("errorMsg");
  const totalBudget = document.getElementById("totalBudget");
  const totalNote = document.getElementById("totalNote");
  const lineItemsEl = document.getElementById("lineItems");
  const resetBtn = document.getElementById("resetBtn");
  const sendBtn = document.getElementById("sendToDealAnalyzer");
  const sendConfirm = document.getElementById("sendConfirm");

  let lastTotal = 0;

  form.addEventListener("submit", function (e) {
    e.preventDefault();
    errorMsg.style.display = "none";

    const sqft = toNumber(document.getElementById("squareFeet").value);
    if (!sqft || sqft <= 0) {
      errorMsg.textContent = "Enter valid square footage.";
      errorMsg.style.display = "block";
      return;
    }

    const kitchensRaw = document.getElementById("kitchens").value.trim();
    const bathroomsRaw = document.getElementById("bathrooms").value.trim();

    const kitchens = kitchensRaw === "" ? 0 : toNumber(kitchensRaw);
    const bathrooms = bathroomsRaw === "" ? 0 : toNumber(bathroomsRaw);

    const windows = toNumber(document.getElementById("numWindows").value);
    const customCont = toNumber(document.getElementById("customContingency").value);
    const condition = document.getElementById("conditionLevel").value;

    let multiplier = 1;
    if (condition === "light") multiplier = 0.9;
    if (condition === "heavy") multiplier = 1.2;

    let items = [];
    let base = 0;

    if (kitchens > 0) {
      let cost = kitchens * COSTS.kitchenPerUnit * multiplier;
      base += cost;
      items.push({ label: `Kitchens (${kitchens})`, value: cost });
    }

    if (bathrooms > 0) {
      let cost = bathrooms * COSTS.bathroomPerUnit * multiplier;
      base += cost;
      items.push({ label: `Bathrooms (${bathrooms})`, value: cost });
    }

    if (windows > 0) {
      let cost = windows * COSTS.windowPerUnit * multiplier;
      base += cost;
      items.push({ label: `Windows (${windows})`, value: cost });
    }

    if (base <= 0) {
      errorMsg.textContent = "Select at least one scope or enter kitchens/bathrooms/windows.";
      errorMsg.style.display = "block";
      return;
    }

    const contingencyPct = customCont > 0 ? customCont : COSTS.defaultContingencyPct;
    const contingency = base * contingencyPct / 100;
    const total = base + contingency;
    lastTotal = Math.round(total);

    totalBudget.textContent = money(total);
    totalNote.textContent =
      `Base ${money(base)} + ${contingencyPct}% contingency (${money(contingency)})`;

    lineItemsEl.innerHTML = "";
    items.forEach(i => {
      lineItemsEl.innerHTML += `<div class="line-item"><span>${i.label}</span><span>${money(i.value)}</span></div>`;
    });
    lineItemsEl.innerHTML += `<div class="line-item-strong"><span>Base total</span><span>${money(base)}</span></div>`;
  });

  resetBtn.addEventListener("click", () => {
    form.reset();
    lastTotal = 0;
    totalBudget.textContent = "$0";
    totalNote.textContent = "Includes contingency";
    lineItemsEl.innerHTML = `<div class="line-item-strong">No estimate yet.</div>`;
    sendConfirm.style.display = "none";
  });

  sendBtn.addEventListener("click", () => {
    if (!lastTotal) {
      errorMsg.textContent = "Run an estimate first.";
      errorMsg.style.display = "block";
      return;
    }
    localStorage.setItem("retotalai_reno_estimate", String(lastTotal));
    sendConfirm.style.display = "block";
    window.location.href = "/deal-analyzer.html";
  });

})();
</script>

</body>
</html>
